"use strict";var listDay=["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],listMonth=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],buttonFastAdd=document.getElementById("btn-fast-add"),pupopFastAdd=document.getElementById("popup-fast-add"),inputFastAdd=document.getElementById("pfa-input"),statusFastAdd=document.getElementById("pfa-status"),buttonFastAddSubmit=document.getElementById("pfa-btn-submit"),buttonFastAddCancel=document.getElementById("pfa-btn-canсel"),buttonFastAddClose=document.getElementById("pfa-btn-close"),buttonUpdate=document.getElementById("btn-update"),inputSerach=document.getElementById("input-search"),buttonEarlier=document.getElementById("btn-earlier"),buttonLater=document.getElementById("btn-later"),buttonCurrent=document.getElementById("btn-current"),buttonMonth=document.getElementById("btn-month"),pupopMonth=document.getElementById("popup-month"),listPupopMonth=document.getElementsByClassName("pm-item"),buttonYear=document.getElementById("btn-year"),calendarArea=document.getElementById("calendar"),dateCurrent=new Date,dateSelected=new Date;dateSelected.setFullYear(dateCurrent.getFullYear(),dateCurrent.getMonth(),dateCurrent.getDate());var timer,setCurrentDate=function(){dateCurrent=new Date,(dateSelected=new Date).setFullYear(dateCurrent.getFullYear(),dateCurrent.getMonth(),dateCurrent.getDate())},setEarlierMonth=function(){dateSelected.setMonth(dateSelected.getMonth()-1)},setLaterMonth=function(){dateSelected.setMonth(dateSelected.getMonth()+1)},setSelectedMonth=function(t){dateSelected.setMonth(t)},getMonthDay=function(){var t=[],e=dateSelected.getMonth(),n=new Date;n.setFullYear(dateSelected.getFullYear(),e,dateSelected.getDate()),n.setDate(1);var a=0==n.getDay()?7:n.getDay();n.setDate(n.getDate()-a+1);for(d=0;d<7;d++)t.push([n.getFullYear(),n.getMonth(),n.getDate()]),n.setDate(n.getDate()+1);for(;n.getMonth()==e;)for(var d=0;d<7;d++)t.push([n.getFullYear(),n.getMonth(),n.getDate()]),n.setDate(n.getDate()+1);return t},getListYear=function(){for(var t=[],e=+dateCurrent.getFullYear()-20;e<+dateCurrent.getFullYear()+50;e++)t.push(e);return t},getIndexDate=function(t){var e=1==(""+t[1]).length?"0"+(t[1]+1):t[1]+1,n=1==(""+t[2]).length?"0"+t[2]:t[2];return[t[0],e,n].join("")},getDateIndex=function(t){var e=[];return e.push(+t.slice(0,4)),e.push(+("0"==t[4]?t[5]:t.slice(4,6))-1),e.push(+("0"==t[6]?t[7]:t.slice(6))),e},changeLableMonth=function(){buttonMonth.innerHTML=listMonth[dateSelected.getMonth()]},changeLableYear=function(){buttonYear.innerHTML=dateSelected.getFullYear()},showStatus=function(t,e,n){clearInterval(timer),t.className="status",t.innerHTML=n,t.classList.add(e),timer=setInterval(function(){t.innerHTML="",t.classList.remove(e)},5e3)},showSelectedMonth=function(){var t=getMonthDay(),e=t.length/7,n=0,a=t[17][1];calendarArea.innerHTML="";for(var d=0;d<e;d++){var o=document.createElement("div");o.classList.add("row");for(var r=0;r<7;r++){var s=document.createElement("div");s.classList.add("col"),t[n][1]!=a&&s.classList.add("unfit");var u=document.createElement("div");u.classList.add("col-date"),u.innerHTML=0==d?listDay[r]+", "+t[n][2]:t[n][2],s.appendChild(u),getDateIndex(getIndexDate(t[n])),s.setAttribute("index-date",getIndexDate(t[n])),n++,o.appendChild(s)}calendarArea.appendChild(o)}},createDOMListMonth=function(){for(var t=0;t<listMonth.length;t++){var e=document.createElement("div");e.classList.add("pm-item"),e.setAttribute("id","pm-item"),e.innerHTML=listMonth[t],pupopMonth.appendChild(e)}},markMonthInList=function(){for(var t=dateSelected.getMonth(),e=0;e<listPupopMonth.length;e++)listPupopMonth[e].classList.remove("active");listPupopMonth[t].classList.add("active")},createDOMListYear=function(){getListYear()},refresh=function(){changeLableMonth(),changeLableYear(),markMonthInList(),showSelectedMonth()};createDOMListMonth(),refresh(),buttonFastAdd.addEventListener("click",function(t){pupopFastAdd.classList.toggle("active")}),buttonFastAddCancel.addEventListener("click",function(t){pupopFastAdd.classList.toggle("active"),inputFastAdd.value=""}),buttonFastAddClose.addEventListener("click",function(t){pupopFastAdd.classList.toggle("active")}),buttonFastAddSubmit.addEventListener("click",function(t){""==inputFastAdd.value?showStatus(statusFastAdd,"error","Заполните поле"):showStatus(statusFastAdd,"succses","Запись добавлена")}),buttonEarlier.addEventListener("click",function(t){setEarlierMonth(),refresh()}),buttonLater.addEventListener("click",function(t){setLaterMonth(),refresh()}),buttonCurrent.addEventListener("click",function(t){setCurrentDate(),refresh()}),window.addEventListener("click",function(t){t.target==buttonMonth&&pupopMonth.classList.toggle("active"),t.target!=buttonMonth&&pupopMonth.classList.contains("active")&&pupopMonth.classList.remove("active")});for(var i=0;i<listPupopMonth.length;i++)listPupopMonth[i].addEventListener("click",function(t){var e=listMonth.indexOf(t.target.innerHTML);setSelectedMonth(e),refresh()});